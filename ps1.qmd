---
title: "ps1"
author: Felicity Zhang
format: html
editor: visual
---

https://github.com/felicityxz17/gov51-ps1.git

## 2 Get to Know Your Data

### 2.1

```{r}
library(tidyverse)
acs2024 <- read.csv("data/raw/acs2024.csv")
```

### 2.2

```{r}
names(acs2024)

table(acs2024$EDUC)
```

`YEAR`: Year the household was included in the census; 4 digits

`SAMPLE`: IPUMS sample identifier; 6 digits (4 for year, 2 for sample)

`SERIAL`: Household serial number (unique identifying number)

`CBSERIAL`: Household serial number assigned by the Census Bureau

`HHWT`: Household weight (number of households in the U.S. population represented by the given sample household)

`CLUSTER`: Variable for variance estimation and correction; 11 digits

`STATEFIP`: State FIPS (Federal Information Processing Standards) code

`GQ`: Group quarters status (households, group quarters, or vacant units)

`PERNUM`: Person number within their household based on order of appearance on the census

`PERWT`: Person weight (number of people in the U.S. population represented by the given sample person); 2 implied decimals

`SEX`: Male (1) or female (2) or missing/blank (9)

`AGE`: Age in years

`EDUC`: Educational attainment measured by highest year of school or degree completed

`EMPSTAT`: Employment status

`INCTOT`: Total pre-tax personal income in the previous year; 7 digit code (9999999 = N/A)

`TRANTIME`: Total number of minutes to get from home to work in the previous week; 3 digits (000 = N/A)

### 2.3

```{r}
# SEX: 1 = Male; 2 = Female; 9 = Missing/blank
acs2024 <- mutate(acs2024, female = ifelse(SEX == 2, 1, 0))

# EDUC: 00-06 = N/A or no schooling through Grade 12; 07-10 = through college; 11 = 5+ years of college
acs2024 <- mutate(acs2024, less_than_hs = ifelse(EDUC < 06, 1, 0))
acs2024 <- mutate(acs2024, hs_only = ifelse(EDUC == 06, 1, 0))
acs2024 <- mutate(acs2024, some_college = ifelse((EDUC > 06) & (EDUC < 10), 1, 0))
acs2024 <- mutate(acs2024, college_only = ifelse(EDUC == 10, 1, 0))
acs2024 <- mutate(acs2024, advanced_degree = ifelse(EDUC > 10, 1, 0))

# EMPSTAT: 0 = N/A; 1 = Employed; 2 = Unemployed; 3 = Not in labor force
acs2024 <- mutate(acs2024, employed = ifelse(EMPSTAT == 1, 1, 0))
acs2024 <- mutate(acs2024, unemployed = ifelse(EMPSTAT == 2, 1, 0))
acs2024 <- mutate(acs2024, not_in_labor_force = ifelse(EMPSTAT == 3, 1, 0))
```

### 2.4

Accidentally treating "N/A" codes as real zeros would likely skew summary statistics by misinterpreting them as actual data points. For instance, the variable `TRANTIME` might become right-skewed due to the inclusion of `000` as indicating 0-minute transit time, incorrectly decreasing summary statistics like mean and median while also expanding the leftward range endpoint to include this value that does not otherwise make sense in the context of the data.

### 2.5

```{r}
#remove N/A values from inctot
INCTOT_modified = acs2024[acs2024$INCTOT != 9999999 & acs2024$INCTOT != 9999998, "INCTOT"]

acs2024_variable <- c("Age", "Female", "Less than High School", "High School Only", "Some College", "College Only", "Advanced Degree", "Employed", "Unemployed", "Not in Labor Force", "Commute Time (mins)", "Total Income ($)")

acs2024_n <- c(length(acs2024$AGE), sum(acs2024$female), sum(acs2024$less_than_hs), sum(acs2024$hs_only), sum(acs2024$some_college), sum(acs2024$college_only), sum(acs2024$advanced_degree), sum(acs2024$employed), sum(acs2024$unemployed), sum(acs2024$not_in_labor_force), length(acs2024$TRANTIME), length(INCTOT_modified))

acs2024_mean <- c(mean(acs2024$AGE), mean(acs2024$female), mean(acs2024$less_than_hs), mean(acs2024$hs_only), mean(acs2024$some_college), mean(acs2024$college_only), mean(acs2024$advanced_degree), mean(acs2024$employed), mean(acs2024$unemployed), mean(acs2024$not_in_labor_force), mean(acs2024$TRANTIME), mean(INCTOT_modified))

acs2024_sd <- c(sd(acs2024$AGE), sd(acs2024$female), sd(acs2024$less_than_hs), sd(acs2024$hs_only), sd(acs2024$some_college), sd(acs2024$college_only), sd(acs2024$advanced_degree), sd(acs2024$employed), sd(acs2024$unemployed), sd(acs2024$not_in_labor_force), sd(acs2024$TRANTIME), sd(INCTOT_modified))

acs2024_min <- c(min(acs2024$AGE), min(acs2024$female), min(acs2024$less_than_hs), min(acs2024$hs_only), min(acs2024$some_college), min(acs2024$college_only), min(acs2024$advanced_degree), min(acs2024$employed), min(acs2024$unemployed), min(acs2024$not_in_labor_force), min(acs2024$TRANTIME), min(INCTOT_modified))

acs2024_max <- c(max(acs2024$AGE), max(acs2024$female), max(acs2024$less_than_hs), max(acs2024$hs_only), max(acs2024$some_college), max(acs2024$college_only), max(acs2024$advanced_degree), max(acs2024$employed), max(acs2024$unemployed), max(acs2024$not_in_labor_force), max(acs2024$TRANTIME), max(INCTOT_modified))

acs2024_stats <- data.frame(acs2024_variable, acs2024_n, acs2024_mean, acs2024_sd, acs2024_min, acs2024_max)

knitr::kable(acs2024_stats, col.names = c("Variable", "N", "Mean", "Std. Dev.", "Min", "Max"), digits = 2, caption = "Table 1. Summary Statistics for 2024 ACS Sample")
```

### 2.6

The maximum commute time, 195 minutes, does not seem to fall into the range of common values of commute times, but is still reasonable as a maximum duration of a daily commute. A one-way commute of a little over 3 hours is similar to a commute length from Salem, MA to Boston, MA, so the data point would make sense for a worker with a home in a rural area and a job in the city.

## 3 Who Should Be in Your Analysis?

### 3.1

```{r}
sum(acs2024$TRANTIME == 0)
sum(acs2024$TRANTIME == 0)/length(acs2024$TRANTIME == 0)

head(acs2024[acs2024$TRANTIME == 0,c("AGE", "EMPSTAT", "INCTOT", "employed", "unemployed", "not_in_labor_force")], 20)
```

2,062,945 people out of the total 3,422,888 observations have `TRANTIME == 0`, representing a percentage of 60.26914%. A sample of the data indicates that these data points largely come from people who are not in the workforce, such as young adults (AGE between 18 and 22) and the retired (positive INCTOT from retirement pension and AGE values mostly over 50). However, it is also plausible that these data points might also include some people who are unemployed (as in the 17th sample entry above) or people who are employed but whose jobs do not require a commute, such as remote workers and care workers.

### 3.2

```{r}
commuters = acs2024[acs2024$TRANTIME != 0,]

sum(commuters$employed == 0)
```

Since the goal of this subset is to analyze commute times for people who actually commute to work, we should remove all data points with a transit time of 0, regardless of the reason that they have 0 transit time. All values greater than 0 are valid values for transit time, so the subset should be based on the condition `TRANTIME > 0`. As a sanity check, we can confirm that everyone in this subset is employed.

### 3.3

```{r}
length(commuters$TRANTIME)
min(commuters$TRANTIME)
```

1,359,943 observations remain, which is consistent with the remaining number of data points from 3.1. The new minimum `TRANTIME` is 1 minute, which makes sense because it still qualifies as a commute and is reasonable for individuals who might live right next to their workplace.

### 3.4
```{r}
#remove N/A values from inctot
INCTOT_modified = commuters[commuters$INCTOT != 9999999 & commuters$INCTOT != 9999998, "INCTOT"]

commuters_variable <- c("Age", "Female", "Less than High School", "High School Only", "Some College", "College Only", "Advanced Degree", "Employed", "Unemployed", "Not in Labor Force", "Commute Time (mins)", "Total Income ($)")

commuters_n <- c(length(commuters$AGE), sum(commuters$female), sum(commuters$less_than_hs), sum(commuters$hs_only), sum(commuters$some_college), sum(commuters$college_only), sum(commuters$advanced_degree), sum(commuters$employed), sum(commuters$unemployed), sum(commuters$not_in_labor_force), length(commuters$TRANTIME), length(INCTOT_modified))

commuters_mean <- c(mean(commuters$AGE), mean(commuters$female), mean(commuters$less_than_hs), mean(commuters$hs_only), mean(commuters$some_college), mean(commuters$college_only), mean(commuters$advanced_degree), mean(commuters$employed), mean(commuters$unemployed), mean(commuters$not_in_labor_force), mean(commuters$TRANTIME), mean(INCTOT_modified))

commuters_sd <- c(sd(commuters$AGE), sd(commuters$female), sd(commuters$less_than_hs), sd(commuters$hs_only), sd(commuters$some_college), sd(commuters$college_only), sd(commuters$advanced_degree), sd(commuters$employed), sd(commuters$unemployed), sd(commuters$not_in_labor_force), sd(commuters$TRANTIME), sd(INCTOT_modified))

commuters_min <- c(min(commuters$AGE), min(commuters$female), min(commuters$less_than_hs), min(commuters$hs_only), min(commuters$some_college), min(commuters$college_only), min(commuters$advanced_degree), min(commuters$employed), min(commuters$unemployed), min(commuters$not_in_labor_force), min(commuters$TRANTIME), min(INCTOT_modified))

commuters_max <- c(max(commuters$AGE), max(commuters$female), max(commuters$less_than_hs), max(commuters$hs_only), max(commuters$some_college), max(commuters$college_only), max(commuters$advanced_degree), max(commuters$employed), max(commuters$unemployed), max(commuters$not_in_labor_force), max(commuters$TRANTIME), max(INCTOT_modified))

commuters_stats <- data.frame(commuters_variable, commuters_n, commuters_mean, commuters_sd, commuters_min, commuters_max)

knitr::kable(commuters_stats, col.names = c("Variable", "N", "Mean", "Std. Dev.", "Min", "Max"), digits = 2, caption = "Table 2. Summary Statistics for 2024 ACS Sample, Commuters Subset")
```

## 4 Visualize and Interpret
### 4.1
```{r}
library(ggplot2)

ggplot(commuters, aes(x = TRANTIME)) + geom_histogram(
  binwidth = 5,
  fill = "#0000FF",
  color = "white"
) + 
  labs(
    title = "Figure 1. Histogram of Commute Times",
    x = "Commute Time (minutes)",
    y = "Number of Workers"
  ) + theme_minimal()
```

### 4.2
The distribution is clearly right-skewed rather than symmetric, with a long right tail extending to values around 155-160 minutes (and likely beyond, given the findings of 2.6). The center of the distribution appears to be somewhere in the range of 20-35 minutes, aligning with the median value of 20 minutes from 3.4, Table 2. The most common commute times, represented by "spikes" in the graph, seem to be between 10-25 minutes and 25-30 minutes, with smaller spikes occurring near 40-45 minutes and 60-65 minutes. There is also a very small relative spike around 90-95 minutes. (These spikes are possibly partly attributable to individual rounding to "nice" times like 15, 30, 60, and 90 minutes.)

### 4.3
```{r}
cat("The mean commute time from 3.4, Table 2 is", round(mean(commuters$TRANTIME), 2), "minutes, while the median commute time is", median(commuters$TRANTIME), "minutes. Since the mean is greater than the median, we can confirm that the distribution is right-skewed, consistent with the histogram in 4.1, Figure 1.") 
```

### 4.4
```{r}
ggsave("output/commute_histogram.png", width = 8, height = 5)
```

## 5 The Weight of Evidence
### 5.1
```{r}
weighted.mean(commuters$TRANTIME, commuters$PERWT)
```

### 5.2
```{r}
cat("Yes, the weighted mean is slightly different from the unweighted mean calculated earlier. While the weighted mean from 5.1 is", round(weighted.mean(commuters$TRANTIME, commuters$PERWT),2), "minutes, the unweighted mean from 4.3 is", round(mean(commuters$TRANTIME), 2), "minutes. The unweighted mean is slightly greater than the weighted mean by about", round(mean(commuters$TRANTIME)-weighted.mean(commuters$TRANTIME, commuters$PERWT),2), "minutes.")
```
### 5.3
```{r}
cat("The unweighted mean indicates that within the given sample, the average commute of respondents who commuted to work was", round(mean(commuters$TRANTIME), 2), "minutes, while the weighted mean indicates that if respondents' commute times are reweighted to match the proportion of the population they represent, then the average commute among individuals in the U.S. who commute to work is estimated by the sample to be", round(weighted.mean(commuters$TRANTIME, commuters$PERWT),2), "minutes.")
```
These numbers might differ if the sample is not representative of the general population; for instance, if the sample includes a large number of individuals living in rural areas who need to make long daily commutes to jobs in urban centers, and the proportion of these individuals in the overall sample is greater than their relative proportion across the U.S., then the unweighted mean would be higher than the weighted mean. However, the fact that the two means are very close in the given sample indicates that the distribution of individual respondents within the sample is representative of the distribution across the entire population. 